H_I = this_H_I, H_S = this_H_S)
df$totinfections_50[i] <- compute_tot_infections(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_50, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
}
df$percent_reduc_inf_99 <- (df$totinfections_notesting - df$totinfections_99)/df$totinfections_notesting*100
df$percent_reduc_inf_50 <- (df$totinfections_notesting - df$totinfections_50)/df$totinfections_notesting*100
proc.time() - ptm
saveRDS(df,file="df_suppFig5_waning_R04_testeveryone.RData")
ptm <- proc.time()
phi_vec <- seq(0, 1, by = 0.05)
psi_vec <- seq(0, 1, by = 0.05)
df <- expand.grid(phi = phi_vec, psi = psi_vec)
df$Reff <- NA
df$Reff_99 <- NA
df$Reff_50 <- NA
df$totinfections_notesting <- NA
df$totinfections_99 <- NA
df$totinfections_50 <- NA
this_VE_I <- baseline_VE_I
this_VE_S <- baseline_VE_S
this_H_I  <- baseline_H_I
this_H_S  <- baseline_H_S
for (i in 1:dim(df)[1]){
df$Reff[i] <- compute_Reff(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = 0, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$Reff_99[i] <- compute_Reff(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_99, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$Reff_50[i] <- compute_Reff(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_50, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$totinfections_notesting[i] <- compute_tot_infections(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = 0, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$totinfections_99[i] <- compute_tot_infections(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_99, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$totinfections_50[i] <- compute_tot_infections(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_50, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
}
df$percent_reduc_inf_99 <- (df$totinfections_notesting - df$totinfections_99)/df$totinfections_notesting*100
df$percent_reduc_inf_50 <- (df$totinfections_notesting - df$totinfections_50)/df$totinfections_notesting*100
proc.time() - ptm
saveRDS(df,file="df_suppFig5_baseline_R04_testeveryone.RData")
ptm <- proc.time()
phi_vec <- seq(0, 1, by = 0.05)
psi_vec <- seq(0, 1, by = 0.05)
df <- expand.grid(phi = phi_vec, psi = psi_vec)
df$Reff <- NA
df$Reff_99 <- NA
df$Reff_50 <- NA
df$totinfections_notesting <- NA
df$totinfections_99 <- NA
df$totinfections_50 <- NA
this_VE_I <- boosted_VE_I
this_VE_S <- boosted_VE_S
this_H_I  <- boosted_H_I
this_H_S  <- boosted_H_S
for (i in 1:dim(df)[1]){
df$Reff[i] <- compute_Reff(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = 0, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$Reff_99[i] <- compute_Reff(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_99, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$Reff_50[i] <- compute_Reff(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_50, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$totinfections_notesting[i] <- compute_tot_infections(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = 0, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$totinfections_99[i] <- compute_tot_infections(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_99, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df$totinfections_50[i] <- compute_tot_infections(df$phi[i], VE_I = this_VE_I, VE_S = this_VE_S,
theta = theta_50, q = this_q,
df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
}
df$percent_reduc_inf_99 <- (df$totinfections_notesting - df$totinfections_99)/df$totinfections_notesting*100
df$percent_reduc_inf_50 <- (df$totinfections_notesting - df$totinfections_50)/df$totinfections_notesting*100
proc.time() - ptm
saveRDS(df,file="df_suppFig5_boosted_R04_testeveryone.RData")
# Dataframes for supp text figure 5 - R0 = 4, testing everyone
waningdf <- readRDS("df_suppFig5_waning_R04_testeveryone.RData")
baselinedf <- readRDS("df_suppFig5_baseline_R04_testeveryone.RData")
boosteddf <- readRDS("df_suppFig5_boosted_R04_testeveryone.RData")
#* II: Plot fig5 ####
for (i in 1:3) {
if (i == 1) {
df <- waningdf
} else if (i==2) {
df <- baselinedf
} else {
df <- boosteddf
}
percentreduc50 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_50)) +
geom_contour(aes(z = Reff_50), breaks = 1, size = 0.6, color = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("") +#"Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
theme(legend.position = "none")
percentreduc99 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_99)) +
geom_contour(aes(z = Reff_99), breaks = 1, size = 0.6, col = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 99% compliance", "% reduction in infections due to testing") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
labs(fill = "") +
theme(axis.title.y = element_blank(),
plot.title = element_blank(),
plot.subtitle = element_blank()) #element_text(hjust = 0.5))
percent_legend <- get_legend(percentreduc99)
if (i == 1){
percentreduc50_waning <- percentreduc50 + onlyy_theme + ggtitle("Waning/low VE")
percentreduc99_waning <- percentreduc99 + theme(legend.position = "none")
} else if (i == 2){
percentreduc50_baseline <- percentreduc50 + nolabels_theme + ggtitle("Baseline VE")
percentreduc99_baseline <- percentreduc99 + onlyx_theme +
theme(legend.position = "none", plot.title = element_blank()) +
xlab("Population vaccination rate (%)")
} else {
percentreduc50_boosted <- percentreduc50 + nolabels_theme + ggtitle("Boosted/high VE")
percentreduc99_boosted <- percentreduc99 + onlyx_theme + theme(legend.position = "none", plot.title = element_blank())
}
}
panels <- ggarrange(percentreduc50_waning, NULL, percentreduc50_baseline, NULL, percentreduc50_boosted,
NULL, NULL, NULL, NULL, NULL,
percentreduc99_waning, NULL, percentreduc99_baseline, NULL, percentreduc99_boosted,
nrow = 3, ncol = 5,
align = "hv",
widths = c(1, -0.14, 1, -0.14, 1),
heights = c(1, -0.22, 1),
labels = c("a", NA, "    b", NA,"    c",
NA, NA, NA, NA, NA,
"d", NA, "    e", NA, "    f"),
label.y = 0.88)
lay <- rbind(c(1, 2))
fig5 <- arrangeGrob(panels, percent_legend, layout_matrix = lay,
widths = c(3, 0.5),
left = c("Infection-acquired immunity (%)"))
fig5
plot(fig5)
ggsave("suppFig5_R04_testeveryone.pdf", fig5, device = cairo_pdf, width = 8, height = 5)
# FIGURE 6: ####
df <- readRDS("df_Fig6_baseline.RData") # plausible omicron
percentreduc50 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_50)) +
geom_contour(aes(z = Reff_50), breaks = 1, size = 0.6, color = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("") +#"Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
theme(legend.position = "none")
percentreduc99 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_99)) +
geom_contour(aes(z = Reff_99), breaks = 1, size = 0.6, col = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 99% compliance", "% reduction in infections due to testing") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
labs(fill = "") +
theme(axis.title.y = element_blank(),
plot.title = element_blank(),
plot.subtitle = element_blank()) #element_text(hjust = 0.5))
percentreducbiwk <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_biwk)) +
geom_contour(aes(z = Reff_biwk), breaks = 1, size = 0.6, col = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("Biweekly testing, 99% compliance", "% reduction in infections due to testing") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
labs(fill = "") +
theme(axis.title.y = element_blank(),
plot.title = element_blank(),
plot.subtitle = element_blank()) #element_text(hjust = 0.5))
percent_legend <- get_legend(percentreducbiwk)
percentreduc50_baseline <- percentreduc50 + alllabels_theme + ggtitle("Weekly, 50% Compliance")
percentreduc99_baseline <- percentreduc99 + onlyx_theme +
theme(legend.position = "none") + ggtitle("Weekly, 99% Compliance") +
xlab("Population vaccination rate (%)")
percentreducbiwk_baseline <- percentreducbiwk + onlyx_theme + ggtitle("Biweekly, 99% Compliance")
panels <- ggarrange(percentreduc50_baseline, NULL,
percentreduc99_baseline, NULL,
percentreducbiwk_baseline,
nrow = 1, ncol = 5,
align = "hv",
widths = c(1, -0.05, 1, -0.05, 1),
labels = c(" a", NA, "   b", NA,"  c"),
label.y = 0.7)
lay <- rbind(c(1, 2))
fig6 <- arrangeGrob(panels, percent_legend, layout_matrix = lay,
widths = c(3, 0.5),
left = c("Infection-acquired immunity (%)"))
fig6
plot(fig6)
df_timeseries <- data.frame()
this_phi
this_psi
this_X_I
this_X_S <- omicron_X_S
this_X_I <- omicron_X_I
this_VE_S <- omicron_VE_S
this_VE_I <- omicron_VE_I
this_H_S <- omicron_H_S
this_H_I <- omicron_H_I
df_notesting <- run_leaky_model(this_phi, this_VE_I, this_VE_S, notesting_theta, this_q,
psi = this_psi, X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df_timeseries$notesting <- df_notesting_reg1$I_v + df_notesting_reg1$I_u + df_notesting_reg1$I_x + df_notesting_reg1$I_h
#* II: Plot fig6 ####
#*
df_timeseries <- data.frame(time = t)
this_phi <- 0.58
df_notesting <- run_leaky_model(this_phi, this_VE_I, this_VE_S, notesting_theta, this_q,
psi = this_psi, X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
df_timeseries$notesting <- df_notesting_reg1$I_v + df_notesting_reg1$I_u + df_notesting_reg1$I_x + df_notesting_reg1$I_h
this_theta
df_timeseries <- data.frame(time = t)
this_phi <- 0.58
theta_vec <- c(0, theta_50, theta_99, theta_99_biwk)
for (i in 1:4){
this_theta <- theta_vec[i]
temp <- run_leaky_model(this_phi, this_VE_I, this_VE_S, this_theta, this_q,
psi = this_psi, X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
I_tot <- temp$I_v + temp$I_u + temp$I_x + temp$I_h
if (i == 1){
df_timeseries$notesting <- I_tot
} else if (i == 2){
df_timeseries$testing50 <- I_tot
} else if (i == 3){
df_timeseries$testing99 <- I_tot
} else {
df_timeseries$testing99_biwk <- I_tot
}
}
A <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing50), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 2500)) + # 2500 for R0 = 6
alllabels_theme
A
A <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing50), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 3000)) + # 2500 for R0 = 6
alllabels_theme
A
A <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing50), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 4000)) + # 2500 for R0 = 6
alllabels_theme
A
A <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing50), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 3500)) + # 2500 for R0 = 6
alllabels_theme
3500
sum(df_timeseries$notesting)
sum(df_timeseries$testing50)
(sum(df_timeseries$notesting)- 72076.78)/107947.9
View(df)
this_phi
this_psi
testing_everyone
testing_everyone <- 0
df_timeseries <- data.frame(time = t)
this_phi <- 0.58
theta_vec <- c(0, theta_50, theta_99, theta_99_biwk)
for (i in 1:4){
this_theta <- theta_vec[i]
temp <- run_leaky_model(this_phi, this_VE_I, this_VE_S, this_theta, this_q,
psi = this_psi, X_I = this_X_I, X_S = this_X_S,
H_I = this_H_I, H_S = this_H_S)
I_tot <- temp$I_v + temp$I_u + temp$I_x + temp$I_h
if (i == 1){
df_timeseries$notesting <- I_tot
} else if (i == 2){
df_timeseries$testing50 <- I_tot
} else if (i == 3){
df_timeseries$testing99 <- I_tot
} else {
df_timeseries$testing99_biwk <- I_tot
}
}
A <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing50), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 3500)) + # 2500 for R0 = 6
alllabels_theme
A
compute_tot_infections(0.58, this_VE_I, this_VE_S, 0, 0, 0.35, this_X_I, this_X_S, this_H_I, this_H_S)
print(compute_tot_infections(0.58, this_VE_I, this_VE_S, 0, 0, 0.35, this_X_I, this_X_S, this_H_I, this_H_S))
print(compute_tot_infections(0.58, this_VE_I, this_VE_S, theta_50, 0, 0.35, this_X_I, this_X_S, this_H_I, this_H_S))
17991.27-17230.15
761/17991.27
infections50 <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing50), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 3500)) + # 2500 for R0 = 6
alllabels_theme
infections99 <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing99), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 3500)) + # 2500 for R0 = 6
alllabels_theme
infections99_biwk <- ggplot(df_timeseries, aes(x = time)) +
geom_line(aes(y = testing99_biwk), col = theta99_purple, size = my_linesize) +
geom_line(aes(y = notesting), col = "black", size = my_linesize) +
ylab("Infected (#)") +
xlab("Time (days)") +
scale_x_continuous(expand = c(0, 0), limits = c(0, 250)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 3500)) + # 2500 for R0 = 6
alllabels_theme
infections99
infections99_biwk
percentreduc50 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_50)) +
geom_contour(aes(z = Reff_50), breaks = 1, size = 0.6, color = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("") +#"Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
theme(legend.position = "none")
percentreduc99 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_99)) +
geom_contour(aes(z = Reff_99), breaks = 1, size = 0.6, col = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 99% compliance", "% reduction in infections due to testing") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
labs(fill = "") +
theme(axis.title.y = element_blank(),
plot.title = element_blank(),
plot.subtitle = element_blank()) #element_text(hjust = 0.5))
percentreducbiwk <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_biwk)) +
geom_contour(aes(z = Reff_biwk), breaks = 1, size = 0.6, col = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
ylab("Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("Biweekly testing, 99% compliance", "% reduction in infections due to testing") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
labs(fill = "") +
theme(axis.title.y = element_blank(),
plot.title = element_blank(),
plot.subtitle = element_blank()) #element_text(hjust = 0.5))
percent_legend <- get_legend(percentreducbiwk)
panels <- ggarrange(timeseries50, NULL,
timeseries99, NULL,
timeseries99_biwk,
percentreduc50_baseline, NULL,
percentreduc99_baseline, NULL,
percentreducbiwk_baseline,
nrow = 2, ncol = 5,
align = "hv",
widths = c(1, -0.05, 1, -0.05, 1),
heights = c(0.5, 1))
panels <- ggarrange(infections50, NULL,
infections99, NULL,
infections99_biwk,
percentreduc50_baseline, NULL,
percentreduc99_baseline, NULL,
percentreducbiwk_baseline,
nrow = 2, ncol = 5,
align = "hv",
widths = c(1, -0.05, 1, -0.05, 1),
heights = c(0.5, 1))
panels
percentreduc50 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_50)) +
geom_contour(aes(z = Reff_50), breaks = 1, size = 0.6, color = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
geom_point(aes(x = 58, y = 35), color = "white") +
ylab("") +#"Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
theme(legend.position = "none")
percentreduc50
percentreduc99 <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_99)) +
geom_contour(aes(z = Reff_99), breaks = 1, size = 0.6, col = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
geom_point(aes(x = 58, y = 35), color = "white") +
ylab("Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 99% compliance", "% reduction in infections due to testing") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
labs(fill = "") +
theme(axis.title.y = element_blank(),
plot.title = element_blank(),
plot.subtitle = element_blank()) #element_text(hjust = 0.5))
percentreducbiwk <- ggplot(df, aes(x = phi*100, y = psi*100)) + #, colour = ..level..)) +
geom_tile(aes(fill = percent_reduc_inf_biwk)) +
geom_contour(aes(z = Reff_biwk), breaks = 1, size = 0.6, col = "white") +
geom_contour(aes(z = Reff), breaks = 1, size = 0.6, col = "white", linetype = "longdash") +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(expand = c(0, 0)) +
geom_point(aes(x = 58, y = 35), color = "white") +
ylab("Infection-acquired immunity (%)") +
xlab("") +# xlab("Population vaccination rate (%)") +
ggtitle("Biweekly testing, 99% compliance", "% reduction in infections due to testing") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits = c(0, 100)) +
coord_fixed(1) +
labs(fill = "") +
theme(axis.title.y = element_blank(),
plot.title = element_blank(),
plot.subtitle = element_blank()) #element_text(hjust = 0.5))
percent_legend <- get_legend(percentreducbiwk)
percentreduc50_baseline <- percentreduc50 + alllabels_theme + ggtitle("Weekly, 50% Compliance")
percentreduc99_baseline <- percentreduc99 + onlyx_theme +
theme(legend.position = "none") + ggtitle("Weekly, 99% Compliance") +
xlab("Population vaccination rate (%)")
percentreducbiwk_baseline <- percentreducbiwk + onlyx_theme + ggtitle("Biweekly, 99% Compliance")
panels <- ggarrange(infections50, NULL,
infections99, NULL,
infections99_biwk,
percentreduc50_baseline, NULL,
percentreduc99_baseline, NULL,
percentreducbiwk_baseline,
nrow = 2, ncol = 5,
align = "hv",
widths = c(1, -0.05, 1, -0.05, 1),
heights = c(0.4, 1))
lay <- rbind(c(1, 2))
fig6 <- arrangeGrob(panels, percent_legend, layout_matrix = lay,
widths = c(3, 0.5),
left = c("Infection-acquired immunity (%)"))
fig6
plot(fig6)
ggsave("exampleFig6.pdf", fig6, device = cairo_pdf, width = 8, height = 5)
