install.packages("faraway", dependencies = TRUE)
install.packages("faraway", dependencies = TRUE)
install.packages("faraway", dependencies = TRUE)
install.packages('faraway', repos='http://cran.us.r-project.org')
library(ggplot2)
library(deSolve)
library(reshape2)
library(plyr)
library(scico)
library(ggpubr)
library(grid)
library(pracma)
setwd("~/student_testing_project")
source("student_testing_helpers.R")
install.packages(c("deSolve", "reshape2", "plyr", "scico", "ggpubr", "grid", "pracma"))
library(ggplot2)
library(deSolve)
library(reshape2)
library(plyr)
library(scico)
library(ggpubr)
library(grid)
library(pracma)
install.packages('ggpubr')
install.packages("ggpubr")
library(ggplot2)
install.packages("ggplot2")
library(ggplot2)
library(ggplot2)
library(ggplot2)
library(deSolve)
library(reshape2)
library(plyr)
library(scico)
library(ggpubr)
library(grid)
library(pracma)
library(r-ggplot2)
library(ggplot)
library(ggplot2)
install.packages("ggplot2")
ggplot2
library(ggplot2)
install.packages("ggplot2")
library(ggplot2)
library(ggplot2)
library(deSolve)
library(reshape2)
library(ggplot2)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2)
library(ggplot2)
1/5/(1-0.7)
1/5
.2*.7
1/0.3
5 * 0.3
5 * 0.5
1/5/(1-0.75
)
1/5/(1-0.5)
16*2.5**2 + 16 + 16*0.8
sqrt(128.8)
2.5**2
3*(6.25+25)+8
8*40.8
sqrt(3**2+4**2)
0.6 * (66+90+104)/3 + 0.4 * 90
(66+90+104)/3
qnorm(0.99,110,40.31^2)
qnorm(0.01,110,40.31^2)
qnorm(99,110,40.31^2)
install.packages("RCurl")
setwd("~/env/ActiveProjects/StudentTesting/unvacc_testing_in_mixed_pop_repo")
# setup.R works correctly if you've already installed fonts. if not, go to setup.R line 22.
source("setup.R")
testing_everyone <- 0 # if 0, just testing unvacc. when implementing testing
# or run simulations
phi_vec <- seq(0.5, 1, by = 0.01)
psi_vec <- seq(0, 1, by = 0.01)
testing_everyone <- 0 # unvaccinated only testing
for (i in 1){
baseline_df <- expand.grid(phi = phi_vec, psi = psi_vec)
baseline_df$breakthroughs_notesting <- NA
baseline_df$breakthroughs_99 <- NA
baseline_df$breakthroughs_50 <- NA
baseline_df$v_transmission_notesting <- NA
baseline_df$v_transmission_99 <- NA
baseline_df$v_transmission_50 <- NA
baseline_df$hosp_notesting <- NA
baseline_df$hosp_99 <- NA
baseline_df$hosp_50 <- NA
baseline_df$VE <- "baseline"
boosted_df <- expand.grid(phi = phi_vec, psi = psi_vec)
boosted_df$breakthroughs_notesting <- NA
boosted_df$breakthroughs_99 <- NA
boosted_df$breakthroughs_50 <- NA
boosted_df$v_transmission_notesting <- NA
boosted_df$v_transmission_99 <- NA
boosted_df$v_transmission_50 <- NA
boosted_df$hosp_notesting <- NA
boosted_df$hosp_99 <- NA
boosted_df$hosp_50 <- NA
boosted_df$VE <- "boosted"
waning_df <- expand.grid(phi = phi_vec, psi = psi_vec)
waning_df$breakthroughs_notesting <- NA
waning_df$breakthroughs_99 <- NA
waning_df$breakthroughs_50 <- NA
waning_df$v_transmission_notesting <- NA
waning_df$v_transmission_99 <- NA
waning_df$v_transmission_50 <- NA
waning_df$hosp_notesting <- NA
waning_df$hosp_99 <- NA
waning_df$hosp_50 <- NA
waning_df$VE <- "low"
omicron_df <- expand.grid(phi = phi_vec, psi = psi_vec)
omicron_df$breakthroughs_notesting <- NA
omicron_df$breakthroughs_99 <- NA
omicron_df$breakthroughs_50 <- NA
omicron_df$breakthroughs_biwk <- NA
omicron_df$v_transmission_notesting <- NA
omicron_df$v_transmission_99 <- NA
omicron_df$v_transmission_50 <- NA
omicron_df$v_transmission_biwk <- NA
omicron_df$hosp_notesting <- NA
omicron_df$hosp_99 <- NA
omicron_df$hosp_50 <- NA
omicron_df$hosp_biwk <- NA
omicron_df$VE <- "omicron"
for (i in 1:dim(omicron_df)[1]){
# Baseline scenario
baseline_df$breakthroughs_notesting[i] <- compute_percent_breakthrough_infections(baseline_df$phi[i],
VE_I = baseline_VE_I, VE_S = baseline_VE_S,
theta = 0, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = baseline_H_I, H_S = baseline_H_S)
baseline_df$breakthroughs_99[i] <- compute_percent_breakthrough_infections(baseline_df$phi[i],
VE_I = baseline_VE_I, VE_S = baseline_VE_S,
theta = theta_99, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = baseline_H_I, H_S = baseline_H_S)
baseline_df$breakthroughs_50[i] <- compute_percent_breakthrough_infections(baseline_df$phi[i],
VE_I = baseline_VE_I, VE_S = baseline_VE_S,
theta = theta_50, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = baseline_H_I, H_S = baseline_H_S)
baseline_df$v_transmission_notesting[i] <- 100 - compute_dominant_transmission(baseline_df$phi[i],
VE_I = baseline_VE_I, VE_S = baseline_VE_S,
theta = 0, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = baseline_H_I, H_S = baseline_H_S) * 100
baseline_df$v_transmission_99[i] <- 100 - compute_dominant_transmission(baseline_df$phi[i],
VE_I = baseline_VE_I, VE_S = baseline_VE_S,
theta = theta_99, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = baseline_H_I, H_S = baseline_H_S) * 100
baseline_df$v_transmission_50[i] <- 100 - compute_dominant_transmission(baseline_df$phi[i],
VE_I = baseline_VE_I, VE_S = baseline_VE_S,
theta = theta_50, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = baseline_H_I, H_S = baseline_H_S) * 100
baseline_df$hosp_notesting[i] <- compute_percent_breakthrough_hosp(baseline_df$phi[i], VE_I = baseline_VE_I, VE_S = baseline_VE_S, VE_P = baseline_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = 0, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = baseline_H_I, H_S = baseline_H_S, H_P = baseline_H_P)
baseline_df$hosp_99[i] <- compute_percent_breakthrough_hosp(baseline_df$phi[i], VE_I = baseline_VE_I, VE_S = baseline_VE_S, VE_P = baseline_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_99, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = baseline_H_I, H_S = baseline_H_S, H_P = baseline_H_P)
baseline_df$hosp_50[i] <- compute_percent_breakthrough_hosp(baseline_df$phi[i],  VE_I = baseline_VE_I, VE_S = baseline_VE_S, VE_P = baseline_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_50, q = this_q,
baseline_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = baseline_H_I, H_S = baseline_H_S, H_P = baseline_H_P)
# Boosted scenario
boosted_df$breakthroughs_notesting[i] <- compute_percent_breakthrough_infections(boosted_df$phi[i],
VE_I = boosted_VE_I, VE_S = boosted_VE_S,
theta = 0, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = boosted_H_I, H_S = boosted_H_S)
boosted_df$breakthroughs_99[i] <- compute_percent_breakthrough_infections(boosted_df$phi[i],
VE_I = boosted_VE_I, VE_S = boosted_VE_S,
theta = theta_99, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = boosted_H_I, H_S = boosted_H_S)
boosted_df$breakthroughs_50[i] <- compute_percent_breakthrough_infections(boosted_df$phi[i],
VE_I = boosted_VE_I, VE_S = boosted_VE_S,
theta = theta_50, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = boosted_H_I, H_S = boosted_H_S)
boosted_df$v_transmission_notesting[i] <- 100 - compute_dominant_transmission(boosted_df$phi[i],
VE_I = boosted_VE_I, VE_S = boosted_VE_S,
theta = 0, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = boosted_H_I, H_S = boosted_H_S) * 100
boosted_df$v_transmission_99[i] <- 100 - compute_dominant_transmission(boosted_df$phi[i],
VE_I = boosted_VE_I, VE_S = boosted_VE_S,
theta = theta_99, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = boosted_H_I, H_S = boosted_H_S) * 100
boosted_df$v_transmission_50[i] <- 100 - compute_dominant_transmission(boosted_df$phi[i],
VE_I = boosted_VE_I, VE_S = boosted_VE_S,
theta = theta_50, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = boosted_H_I, H_S = boosted_H_S) * 100
boosted_df$hosp_notesting[i] <- compute_percent_breakthrough_hosp(boosted_df$phi[i], VE_I = boosted_VE_I, VE_S = boosted_VE_S, VE_P = boosted_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = 0, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = boosted_H_I, H_S = boosted_H_S, H_P = boosted_H_P)
boosted_df$hosp_99[i] <- compute_percent_breakthrough_hosp(boosted_df$phi[i], VE_I = boosted_VE_I, VE_S = boosted_VE_S, VE_P = boosted_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_99, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = boosted_H_I, H_S = boosted_H_S, H_P = boosted_H_P)
boosted_df$hosp_50[i] <- compute_percent_breakthrough_hosp(boosted_df$phi[i], VE_I = boosted_VE_I, VE_S = boosted_VE_S, VE_P = boosted_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_50, q = this_q,
boosted_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = boosted_H_I, H_S = boosted_H_S, H_P = boosted_H_P)
# Low VE scenario
waning_df$breakthroughs_notesting[i] <- compute_percent_breakthrough_infections(waning_df$phi[i],
VE_I = waning_VE_I, VE_S = waning_VE_S,
theta = 0, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = waning_H_I, H_S = waning_H_S)
waning_df$breakthroughs_99[i] <- compute_percent_breakthrough_infections(waning_df$phi[i],
VE_I = waning_VE_I, VE_S = waning_VE_S,
theta = theta_99, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = waning_H_I, H_S = waning_H_S)
waning_df$breakthroughs_50[i] <- compute_percent_breakthrough_infections(waning_df$phi[i],
VE_I = waning_VE_I, VE_S = waning_VE_S,
theta = theta_50, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = waning_H_I, H_S = waning_H_S)
waning_df$v_transmission_notesting[i] <- 100 - compute_dominant_transmission(waning_df$phi[i],
VE_I = waning_VE_I, VE_S = waning_VE_S,
theta = 0, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = waning_H_I, H_S = waning_H_S) * 100
waning_df$v_transmission_99[i] <- 100 - compute_dominant_transmission(waning_df$phi[i],
VE_I = waning_VE_I, VE_S = waning_VE_S,
theta = theta_99, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = waning_H_I, H_S = waning_H_S) * 100
waning_df$v_transmission_50[i] <- 100 - compute_dominant_transmission(waning_df$phi[i],
VE_I = waning_VE_I, VE_S = waning_VE_S,
theta = theta_50, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = waning_H_I, H_S = waning_H_S) * 100
waning_df$hosp_notesting[i] <- compute_percent_breakthrough_hosp(waning_df$phi[i], VE_I = waning_VE_I, VE_S = waning_VE_S, VE_P = waning_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = 0, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = waning_H_I, H_S = waning_H_S, H_P = waning_H_P)
waning_df$hosp_99[i] <- compute_percent_breakthrough_hosp(waning_df$phi[i], VE_I = waning_VE_I, VE_S = waning_VE_S, VE_P = waning_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_99, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = waning_H_I, H_S = waning_H_S, H_P = waning_H_P)
waning_df$hosp_50[i] <- compute_percent_breakthrough_hosp(waning_df$phi[i], VE_I = waning_VE_I, VE_S = waning_VE_S, VE_P = waning_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_50, q = this_q,
waning_df$psi[i], X_I = this_X_I, X_S = this_X_S, X_P = this_X_P,
H_I = waning_H_I, H_S = waning_H_S, H_P = waning_H_P)
# Omicron scenario
omicron_df$breakthroughs_notesting[i] <- compute_percent_breakthrough_infections(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = 0, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S)
omicron_df$breakthroughs_99[i] <- compute_percent_breakthrough_infections(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = theta_99, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S)
omicron_df$breakthroughs_50[i] <- compute_percent_breakthrough_infections(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = theta_50, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S)
omicron_df$breakthroughs_biwk[i] <- compute_percent_breakthrough_infections(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = theta_99_biwk, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S)
omicron_df$v_transmission_notesting[i] <- 100 - compute_dominant_transmission(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = 0, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S) * 100
omicron_df$v_transmission_99[i] <- 100 - compute_dominant_transmission(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = theta_99, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S) * 100
omicron_df$v_transmission_50[i] <- 100 - compute_dominant_transmission(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = theta_50, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S) * 100
omicron_df$v_transmission_biwk[i] <- 100 - compute_dominant_transmission(omicron_df$phi[i],
VE_I = omicron_VE_I, VE_S = omicron_VE_S,
theta = theta_99_biwk, q = this_q,
omicron_df$psi[i], X_I = this_X_I, X_S = this_X_S,
H_I = omicron_H_I, H_S = omicron_H_S) * 100
omicron_df$hosp_notesting[i] <- compute_percent_breakthrough_hosp(omicron_df$phi[i], VE_I = omicron_VE_I, VE_S = omicron_VE_S, VE_P = omicron_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = 0, q = this_q,
omicron_df$psi[i], X_I = omicron_X_I, X_S = omicron_X_S, X_P = omicron_X_P,
H_I = omicron_H_I, H_S = omicron_H_S, H_P = omicron_H_P)
omicron_df$hosp_99[i] <- compute_percent_breakthrough_hosp(omicron_df$phi[i], VE_I = omicron_VE_I, VE_S = omicron_VE_S, VE_P = omicron_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_99, q = this_q,
omicron_df$psi[i], X_I = omicron_X_I, X_S = omicron_X_S, X_P = omicron_X_P,
H_I = omicron_H_I, H_S = omicron_H_S, H_P = omicron_H_P)
omicron_df$hosp_50[i] <- compute_percent_breakthrough_hosp(omicron_df$phi[i], VE_I = omicron_VE_I, VE_S = omicron_VE_S, VE_P = omicron_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_50, q = this_q,
omicron_df$psi[i], X_I = omicron_X_I, X_S = omicron_X_S, X_P = omicron_X_P,
H_I = omicron_H_I, H_S = omicron_H_S, H_P = omicron_H_P)
omicron_df$hosp_biwk[i] <- compute_percent_breakthrough_hosp(omicron_df$phi[i], VE_I = omicron_VE_I, VE_S = omicron_VE_S, VE_P = omicron_VE_P,
infection_hosp_rate = infection_hosp_rate_delta,
theta = theta_50, q = this_q,
omicron_df$psi[i], X_I = omicron_X_I, X_S = omicron_X_S, X_P = omicron_X_P,
H_I = omicron_H_I, H_S = omicron_H_S, H_P = omicron_H_P)
}
# compute summary statistics
VEs <- c(rep(baseline_VE_S,3),rep(boosted_VE_S,3),rep(waning_VE_S,3),rep(omicron_VE_S,4))
df <- data.frame(VE = VEs)
df$testing <- c(rep(c(0,50,99),3),c(0,50,99,299))
df$max_inf_transition <- NA
df$min_inf_transition <- NA
df$max_trnsmsn_transition <- NA
df$min_trnsmsn_transition <- NA
df$max_hosp_transition <- NA
df$min_hosp_transition <- NA
# Baseline VE
baseline_inf_transitions_notesting <- baseline_df[baseline_df$breakthroughs_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==baseline_VE_S,]$min_inf_transition <- min(baseline_inf_transitions_notesting$phi)
df[df$testing==0 & df$VE==baseline_VE_S,]$max_inf_transition <-  max(baseline_inf_transitions_notesting$phi)
baseline_inf_transitions_99 <- baseline_df[baseline_df$breakthroughs_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==baseline_VE_S,]$min_inf_transition <- min(baseline_inf_transitions_99$phi)
df[df$testing==99 & df$VE==baseline_VE_S,]$max_inf_transition <- max(baseline_inf_transitions_99$phi)
baseline_inf_transitions_50 <- baseline_df[baseline_df$breakthroughs_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==baseline_VE_S,]$min_inf_transition <- min(baseline_inf_transitions_50$phi)
df[df$testing==50 & df$VE==baseline_VE_S,]$max_inf_transition <- max(baseline_inf_transitions_50$phi)
baseline_trnsmsn_transitions_notesting <- baseline_df[baseline_df$v_transmission_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==baseline_VE_S,]$min_trnsmsn_transition <- min(baseline_trnsmsn_transitions_notesting$phi)
df[df$testing==0 & df$VE==baseline_VE_S,]$max_trnsmsn_transition <-  max(baseline_trnsmsn_transitions_notesting$phi)
baseline_trnsmsn_transitions_99 <- baseline_df[baseline_df$v_transmission_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==baseline_VE_S,]$min_trnsmsn_transition <- min(baseline_trnsmsn_transitions_99$phi)
df[df$testing==99 & df$VE==baseline_VE_S,]$max_trnsmsn_transition <- max(baseline_trnsmsn_transitions_99$phi)
baseline_trnsmsn_transitions_50 <- baseline_df[baseline_df$v_transmission_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==baseline_VE_S,]$min_trnsmsn_transition <- min(baseline_trnsmsn_transitions_50$phi)
df[df$testing==50 & df$VE==baseline_VE_S,]$max_trnsmsn_transition <- max(baseline_trnsmsn_transitions_50$phi)
baseline_hosp_transitions_notesting <- baseline_df[baseline_df$hosp_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==baseline_VE_S,]$min_hosp_transition <- min(baseline_hosp_transitions_notesting$phi)
df[df$testing==0 & df$VE==baseline_VE_S,]$max_hosp_transition <-  max(baseline_hosp_transitions_notesting$phi)
baseline_hosp_transitions_99 <- baseline_df[baseline_df$hosp_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==baseline_VE_S,]$min_hosp_transition <- min(baseline_hosp_transitions_99$phi)
df[df$testing==99 & df$VE==baseline_VE_S,]$max_hosp_transition <- max(baseline_hosp_transitions_99$phi)
baseline_hosp_transitions_50 <- baseline_df[baseline_df$hosp_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==baseline_VE_S,]$min_hosp_transition <- min(baseline_hosp_transitions_50$phi)
df[df$testing==50 & df$VE==baseline_VE_S,]$max_hosp_transition <- max(baseline_hosp_transitions_50$phi)
# Boosted VE
boosted_inf_transitions_notesting <- boosted_df[boosted_df$breakthroughs_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==boosted_VE_S,]$min_inf_transition <- min(boosted_inf_transitions_notesting$phi)
df[df$testing==0 & df$VE==boosted_VE_S,]$max_inf_transition <-  max(boosted_inf_transitions_notesting$phi)
boosted_inf_transitions_99 <- baseline_df[boosted_df$breakthroughs_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==boosted_VE_S,]$min_inf_transition <- min(boosted_inf_transitions_99$phi)
df[df$testing==99 & df$VE==boosted_VE_S,]$max_inf_transition <- max(boosted_inf_transitions_99$phi)
boosted_inf_transitions_50 <- boosted_df[boosted_df$breakthroughs_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==boosted_VE_S,]$min_inf_transition <- min(boosted_inf_transitions_50$phi)
df[df$testing==50 & df$VE==boosted_VE_S,]$max_inf_transition <- max(boosted_inf_transitions_50$phi)
boosted_trnsmsn_transitions_notesting <- boosted_df[boosted_df$v_transmission_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==boosted_VE_S,]$min_trnsmsn_transition <- min(boosted_trnsmsn_transitions_notesting$phi)
df[df$testing==0 & df$VE==boosted_VE_S,]$max_trnsmsn_transition <- max(boosted_trnsmsn_transitions_notesting$phi)
boosted_trnsmsn_transitions_99 <- boosted_df[boosted_df$v_transmission_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==boosted_VE_S,]$min_trnsmsn_transition <- min(boosted_trnsmsn_transitions_99$phi)
df[df$testing==99 & df$VE==boosted_VE_S,]$max_trnsmsn_transition <- max(boosted_trnsmsn_transitions_99$phi)
boosted_trnsmsn_transitions_50 <- boosted_df[boosted_df$v_transmission_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==boosted_VE_S,]$min_trnsmsn_transition <- min(boosted_trnsmsn_transitions_50$phi)
df[df$testing==50 & df$VE==boosted_VE_S,]$max_trnsmsn_transition <- max(boosted_trnsmsn_transitions_50$phi)
boosted_hosp_transitions_notesting <- boosted_df[boosted_df$hosp_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==boosted_VE_S,]$min_hosp_transition <- min(boosted_hosp_transitions_notesting$phi)
df[df$testing==0 & df$VE==boosted_VE_S,]$max_hosp_transition <- max(boosted_hosp_transitions_notesting$phi)
boosted_hosp_transitions_99 <- boosted_df[boosted_df$hosp_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==boosted_VE_S,]$min_hosp_transition <- min(boosted_hosp_transitions_99$phi)
df[df$testing==99 & df$VE==boosted_VE_S,]$max_hosp_transition <- max(boosted_hosp_transitions_99$phi)
boosted_hosp_transitions_50 <- boosted_df[boosted_df$hosp_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==boosted_VE_S,]$min_hosp_transition <- min(boosted_hosp_transitions_50$phi)
df[df$testing==50 & df$VE==boosted_VE_S,]$max_hosp_transition <- max(boosted_hosp_transitions_50$phi)
# Low VE
waning_inf_transitions_notesting <- waning_df[waning_df$breakthroughs_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==waning_VE_S,]$min_inf_transition <- min(waning_inf_transitions_notesting$phi)
df[df$testing==0 & df$VE==waning_VE_S,]$max_inf_transition <-  max(waning_inf_transitions_notesting$phi)
waning_inf_transitions_99 <- waning_df[waning_df$breakthroughs_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==waning_VE_S,]$min_inf_transition <- min(waning_inf_transitions_99$phi)
df[df$testing==99 & df$VE==waning_VE_S,]$max_inf_transition <- max(waning_inf_transitions_99$phi)
waning_inf_transitions_50 <- waning_df[waning_df$breakthroughs_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==waning_VE_S,]$min_inf_transition <- min(waning_inf_transitions_50$phi)
df[df$testing==50 & df$VE==waning_VE_S,]$max_inf_transition <- max(waning_inf_transitions_50$phi)
waning_trnsmsn_transitions_notesting <- waning_df[waning_df$v_transmission_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==waning_VE_S,]$min_trnsmsn_transition <- min(waning_trnsmsn_transitions_notesting$phi)
df[df$testing==0 & df$VE==waning_VE_S,]$max_trnsmsn_transition <- max(waning_trnsmsn_transitions_notesting$phi)
waning_trnsmsn_transitions_99 <- waning_df[waning_df$v_transmission_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==waning_VE_S,]$min_trnsmsn_transition <- min(waning_trnsmsn_transitions_99$phi)
df[df$testing==99 & df$VE==waning_VE_S,]$max_trnsmsn_transition <- max(waning_trnsmsn_transitions_99$phi)
waning_trnsmsn_transitions_50 <- waning_df[waning_df$v_transmission_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==waning_VE_S,]$min_trnsmsn_transition <- min(waning_trnsmsn_transitions_50$phi)
df[df$testing==50 & df$VE==waning_VE_S,]$max_trnsmsn_transition <- max(waning_trnsmsn_transitions_50$phi)
waning_hosp_transitions_notesting <- waning_df[waning_df$hosp_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==waning_VE_S,]$min_hosp_transition <- min(waning_hosp_transitions_notesting$phi)
df[df$testing==0 & df$VE==waning_VE_S,]$max_hosp_transition <- max(waning_hosp_transitions_notesting$phi)
waning_hosp_transitions_99 <- waning_df[waning_df$hosp_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==waning_VE_S,]$min_hosp_transition <- min(waning_hosp_transitions_99$phi)
df[df$testing==99 & df$VE==waning_VE_S,]$max_hosp_transition <- max(waning_hosp_transitions_99$phi)
waning_hosp_transitions_50 <- waning_df[waning_df$hosp_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==waning_VE_S,]$min_hosp_transition <- min(waning_hosp_transitions_50$phi)
df[df$testing==50 & df$VE==waning_VE_S,]$max_hosp_transition <- max(waning_hosp_transitions_50$phi)
# Omicron VE
omicron_inf_transitions_notesting <- omicron_df[omicron_df$breakthroughs_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==omicron_VE_S,]$min_inf_transition <- min(omicron_inf_transitions_notesting$phi)
df[df$testing==0 & df$VE==omicron_VE_S,]$max_inf_transition <-  max(omicron_inf_transitions_notesting$phi)
omicron_inf_transitions_99 <- omicron_df[omicron_df$breakthroughs_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==omicron_VE_S,]$min_inf_transition <- min(omicron_inf_transitions_99$phi)
df[df$testing==99 & df$VE==omicron_VE_S,]$max_inf_transition <- max(omicron_inf_transitions_99$phi)
omicron_inf_transitions_50 <- omicron_df[omicron_df$breakthroughs_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==omicron_VE_S,]$min_inf_transition <- min(omicron_inf_transitions_50$phi)
df[df$testing==50 & df$VE==omicron_VE_S,]$max_inf_transition <- max(omicron_inf_transitions_50$phi)
omicron_inf_transitions_biwk <- omicron_df[omicron_df$breakthroughs_biwk >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==299 & df$VE==omicron_VE_S,]$min_inf_transition <- min(omicron_inf_transitions_biwk$phi)
df[df$testing==299 & df$VE==omicron_VE_S,]$max_inf_transition <- max(omicron_inf_transitions_biwk$phi)
omicron_trnsmsn_transitions_notesting <- omicron_df[omicron_df$v_transmission_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==omicron_VE_S,]$min_trnsmsn_transition <- min(omicron_trnsmsn_transitions_notesting$phi)
df[df$testing==0 & df$VE==omicron_VE_S,]$max_trnsmsn_transition <-  max(omicron_trnsmsn_transitions_notesting$phi)
omicron_trnsmsn_transitions_99 <- omicron_df[omicron_df$v_transmission_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==omicron_VE_S,]$min_trnsmsn_transition <- min(omicron_trnsmsn_transitions_99$phi)
df[df$testing==99 & df$VE==omicron_VE_S,]$max_trnsmsn_transition <- max(omicron_trnsmsn_transitions_99$phi)
omicron_trnsmsn_transitions_50 <- omicron_df[omicron_df$v_transmission_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==omicron_VE_S,]$min_trnsmsn_transition <- min(omicron_trnsmsn_transitions_50$phi)
df[df$testing==50 & df$VE==omicron_VE_S,]$max_trnsmsn_transition <- max(omicron_trnsmsn_transitions_50$phi)
omicron_trnsmsn_transitions_biwk <- omicron_df[omicron_df$v_transmission_biwk >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==299 & df$VE==omicron_VE_S,]$min_trnsmsn_transition <- min(omicron_trnsmsn_transitions_biwk$phi)
df[df$testing==299 & df$VE==omicron_VE_S,]$max_trnsmsn_transition <- max(omicron_trnsmsn_transitions_biwk$phi)
omicron_hosp_transitions_notesting <- omicron_df[omicron_df$hosp_notesting >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==0 & df$VE==omicron_VE_S,]$min_hosp_transition <- min(omicron_hosp_transitions_notesting$phi)
df[df$testing==0 & df$VE==omicron_VE_S,]$max_hosp_transition <-  max(omicron_hosp_transitions_notesting$phi)
omicron_hosp_transitions_99 <- omicron_df[omicron_df$hosp_99 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==99 & df$VE==omicron_VE_S,]$min_hosp_transition <- min(omicron_hosp_transitions_99$phi)
df[df$testing==99 & df$VE==omicron_VE_S,]$max_hosp_transition <- max(omicron_hosp_transitions_99$phi)
omicron_hosp_transitions_50 <- omicron_df[omicron_df$hosp_50 >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==50 & df$VE==omicron_VE_S,]$min_hosp_transition <- min(omicron_hosp_transitions_50$phi)
df[df$testing==50 & df$VE==omicron_VE_S,]$max_hosp_transition <- max(omicron_hosp_transitions_50$phi)
omicron_hosp_transitions_biwk <- omicron_df[omicron_df$hosp_biwk >= 50,] %>%
group_by(psi) %>% summarize(phi=min(phi))
df[df$testing==299 & df$VE==omicron_VE_S,]$min_hosp_transition <- min(omicron_hosp_transitions_biwk$phi)
df[df$testing==299 & df$VE==omicron_VE_S,]$max_hosp_transition <- max(omicron_hosp_transitions_biwk$phi)
df$labels <- NA
df[df$VE == waning_VE_S,]$labels <- "Waning (Low VE)"
df[df$VE == baseline_VE_S,]$labels <- "Baseline VE"
df[df$VE == boosted_VE_S,]$labels <- "Boosted (High VE)"
df[df$VE == omicron_VE_S,]$labels <- "Omicron"
}
saveRDS(baseline_df, "df_Fig7_baseline.RData")
saveRDS(boosted_df, "df_Fig7_boosted.RData")
saveRDS(waning_df, "df_Fig7_waning.RData")
saveRDS(omicron_df, "df_Fig7_omicron.RData")
