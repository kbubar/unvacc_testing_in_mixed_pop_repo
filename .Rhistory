stat_contour(aes(z = Reff), breaks = 1, size = 0.5, col = mygray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("")+ #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.position = "none",
plot.subtitle = element_text(hjust = 0.5))
ggarrange(infectavert_mod, infper100_mod,
ncol= 1)
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.25, 0.05),
heights = c(1, -0.1, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
View(df)
this_elem <- which(is.na(df))
df[this_elem] <- 0
df[[this_elem]] <- 0
df[this_elem]
this_elem
this_elem <- which(is.na(df), array.ind = FALSE)
this_elem <- which(is.na(df), arr.ind = FALSE)
this_elem
df[is.na(df)] <- 0
is.na(dF)
is.na(df)
which(is.na(df))
infectavert_mod <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_mod)) +
geom_tile() +
stat_contour(aes(z = Reff_mod), breaks = 1, size = 0.6, col = "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 99% compliance", "")+#"Infections averted\nrel. to no testing") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,12000)) +
theme(legend.text = element_text(size = 11),
legend.spacing.x = unit(0.75, 'cm'),
plot.title = element_text(color = myblue),
plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank())
infectavert_real <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_real)) +
geom_tile() +
stat_contour(aes(z = Reff_real), breaks = 1, size = 0.6, col =  "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 50% compliance", "") +# "Infections averted\nrel. to no testing") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,12000)) +
theme(legend.position = "none",
plot.title = element_text(color = myyellow),
plot.subtitle = element_text(hjust = 0.5))
infper100_mod <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_per100_mod)) +
geom_tile() +
stat_contour(aes(z = Reff_mod), breaks = 1, size = 0.6, col =  "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("") + #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.text = element_text(size = 11),
legend.spacing.x = unit(0.75, 'cm'),
legend.text.align = 0,
plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank())
infper100_real <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_per100_real)) +
geom_tile() +
stat_contour(aes(z = Reff_real), breaks = 1, size = 0.5, col = "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.5, col = mygray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("")+ #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.position = "none",
plot.subtitle = element_text(hjust = 0.5))
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.25, 0.05),
heights = c(1, -0.1, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
infper100_real <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_per100_real)) +
geom_tile() +
stat_contour(aes(z = Reff_real), breaks = 1, size = 0.6, col = "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("")+ #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.position = "none",
plot.subtitle = element_text(hjust = 0.5))
remotes::install_version("Rttf2pt1", version = "1.3.8")
library(extrafont)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.2, 0.05),
heights = c(1, -0.1, 1),
align = "hv")
warnings()
# font_import()
loadfonts(device = "win")
# font_import()
loadfonts(device = "win", quiet = "true")
# font_import()
loadfonts(device = "win", quiet = TRUE)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.2, 0.05),
heights = c(1, -0.1, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
# Either read in the corresponding RDS file
df <- readRDS("df_fig4_setupparams.RData")
View(df)
infectavert_mod
infectavert_mod <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_mod)) +
geom_tile() +
stat_contour(aes(z = Reff_mod), breaks = 1, size = 0.6, col = "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 99% compliance", "")+#"Infections averted\nrel. to no testing") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,12000)) +
theme(legend.text = element_text(size = 11),
legend.spacing.x = unit(0.75, 'cm'),
plot.title = element_text(color = myblue),
plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank()) +
coord_fixed(1)
infectavert_real <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_real)) +
geom_tile() +
stat_contour(aes(z = Reff_real), breaks = 1, size = 0.6, col =  "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 50% compliance", "") +# "Infections averted\nrel. to no testing") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,12000)) +
theme(legend.position = "none",
plot.title = element_text(color = myyellow),
plot.subtitle = element_text(hjust = 0.5)) +
coord_fixed(1)
infper100_mod <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_per100_mod)) +
geom_tile() +
stat_contour(aes(z = Reff_mod), breaks = 1, size = 0.6, col =  "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("") + #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.text = element_text(size = 11),
legend.spacing.x = unit(0.75, 'cm'),
legend.text.align = 0,
plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank()) +
coord_fixed(1)
infper100_real <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_per100_real)) +
geom_tile() +
stat_contour(aes(z = Reff_real), breaks = 1, size = 0.6, col = "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("")+ #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.position = "none",
plot.subtitle = element_text(hjust = 0.5)) +
coord_fixed(1)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.2, 0.05),
heights = c(1, -0.1, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 7, height = 8)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.2, 0.05),
heights = c(1, -0.14, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1, 0.05),
heights = c(1, -0.14, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
infectavert_mod <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_mod)) +
geom_tile() +
stat_contour(aes(z = Reff_mod), breaks = 1, size = 0.6, col = "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 99% compliance", "")+#"Infections averted\nrel. to no testing") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,12000)) +
theme(legend.text = element_text(size = 11),
legend.spacing.x = unit(0.75, 'cm'),
plot.title = element_text(color = myblue),
plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank()) +
coord_fixed(1)
infectavert_real <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_real)) +
geom_tile() +
stat_contour(aes(z = Reff_real), breaks = 1, size = 0.6, col =  "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("Weekly testing, 50% compliance", "") +# "Infections averted\nrel. to no testing") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,12000)) +
theme(legend.position = "none",
plot.title = element_text(color = myyellow),
plot.subtitle = element_text(hjust = 0.5)) +
coord_fixed(1)
infper100_mod <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_per100_mod)) +
geom_tile() +
stat_contour(aes(z = Reff_mod), breaks = 1, size = 0.6, col =  "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("") + #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.text = element_text(size = 11),
legend.spacing.x = unit(0.75, 'cm'),
legend.text.align = 0,
plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank()) +
coord_fixed(1)
infper100_real <- ggplot(df, aes(x = phi*100, y = psi*100, fill = infections_averted_per100_real)) +
geom_tile() +
stat_contour(aes(z = Reff_real), breaks = 1, size = 0.6, col = "white") +
stat_contour(aes(z = Reff), breaks = 1, size = 0.6, col = mylightgray) +
scale_y_continuous(expand = c(0,0)) +
scale_x_continuous(expand = c(0,0)) +
ylab("") + #ylab("Infection-acquired immunity (%)") +
xlab("") + #xlab("Population vaccination rate (%)") +
ggtitle("")+ #subtitle = "Infections averted per 100 tests") +
labs(fill = "") +
scale_fill_gradientn(colours = cet_pal(5, name = "inferno"), limits=c(0,5)) +
theme(legend.position = "none",
plot.subtitle = element_text(hjust = 0.5)) +
coord_fixed(1)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1, 0.05),
heights = c(1, -0.14, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.2, 0.05),
heights = c(1, -0.14, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.18, 0.05),
heights = c(1, -0.14, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
fig4 <- ggarrange(infectavert_real, infectavert_mod, NULL,
NULL,NULL,NULL,
infper100_real, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 8)
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 3, nrow = 3,
widths = c(1, -0.2, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.2, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.24, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.21, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.18, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.1, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.05, 1.18, 0.05),
heights = c(1, -0.16, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.05, 1.17, 0.05),
heights = c(1, -0.15, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.05, 1.175, 0.05),
heights = c(1, -0.13, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
fig4 <- ggarrange(infectavert_real, NULL, infectavert_mod, NULL,
NULL,NULL,NULL, NULL,
infper100_real, NULL, infper100_mod, NULL,
ncol = 4, nrow = 3,
widths = c(1, -0.05, 1.178, 0.05),
heights = c(1, -0.11, 1),
align = "hv")
annotate_figure(fig4,
bottom = text_grob("Population vaccination rate (%)", size = 14, family = "Arial",
vjust = -1.2),
left = text_grob("Infection-acquired immunity(%)", size = 14, family = "Arial", rot = 90,
vjust = 1.1))
ggsave("fig4_heatmap.pdf", device = cairo_pdf, width = 8, height = 7.5)
ggsave("fig4_heatmap.svg", device = svg, width = 8, height = 7.5)
